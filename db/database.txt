create database bones;
\c bones

create table usuario(id_usuario serial primary key,
                nombre_usuario varchar(24) not null,
                ap_pat_usuario varchar(32),
                ap_mat_usuario varchar(32),
                correo varchar(64) unique not null,
                contrasena varchar(32) not null,
                no_telefono bigint);

create table cliente(id_cliente serial primary key,
                id_usuario int, foreign key(id_usuario) references usuario(id_usuario) on update cascade on delete cascade,
                preferencias varchar(256));

create table supervisor(id_supervisor serial primary key,
                id_usuario int, foreign key(id_usuario) references usuario(id_usuario) on update cascade on delete cascade);

create table museo(id_museo serial primary key,
                nombre varchar(128) not null,
                categoria varchar(256) not null,
                estado varchar(64) not null,
                colonia varchar(128) not null,
                calle varchar(128) not null,
                detalles varchar(512),
                n_interior int,
                n_exterior int,
                reputacion float check(reputacion >= 0 and reputacion <= 5) default 0,
                visitas int default 0,
                vid_url varchar(1024),
                img_url varchar(6150));

create table proveedor(id_supervisor serial primary key,
                id_usuario int, foreign key(id_usuario) references usuario(id_usuario) on update cascade on delete cascade,
                id_museo int, foreign key(id_museo) references museo(id_museo) on update cascade on delete cascade);

create table boleto(id_boleto serial primary key,
                id_cliente int, foreign key(id_cliente) references cliente(id_cliente) on update cascade on delete cascade,
                fecha_compra date,
                fecha_vencimiento date,
                descripcion varchar(512));

create table comentario(id_comentario serial primary key,
                id_comentario_responde int, foreign key(id_comentario_responde) references comentario(id_comentario),
                id_usuario int, foreign key(id_usuario) references usuario(id_usuario) on update cascade on delete cascade,
                id_supervisor int, foreign key(id_supervisor) references supervisor(id_supervisor) on update cascade on delete cascade,
                texto varchar(512) not null);

create table pago(id_pago serial primary key,
                cantidad float not null,
                fecha_pago date not null);

create table paypal(id_paypal int,
                primary key(id_paypal), foreign key(id_paypal) references pago(id_pago));

create table tarjeta(id_tarjeta int,
                primary key(id_tarjeta), foreign key(id_tarjeta) references pago(id_pago) on update cascade on delete cascade);

create table valoracion(id_valoracion serial primary key,
                id_cliente int, foreign key(id_cliente) references cliente(id_cliente) on update cascade on delete cascade,
                estrellas int check(estrellas >= 1 and estrellas <= 5) not null,
                opinion varchar(256) not null);

insert into usuario(nombre_usuario, correo, contrasena) values('Admin', 'admin@email.com', 'admin.1234');

categorias disponibles "Arte Cultura Arqueologia Tecnologia Arquitectura Antropologia Etniografia";
insert into museo(nombre, categoria, estado, colonia, calle, detalles, reputacion, visitas) values
    ('Delta', ' Cultura Arqueologia Tecnologia Arquitectura ', 'Estado de México', 'Tecamac', 'Jardines del mar', 'Vamos a suponer que es mi casa xd', 5, 1000),
    ('Theta', ' Tecnologia Antropologia Arqueologia ', 'Estado de México', 'Ecatepec', 'Benito Juárez', 'Es una prueba', 4.2, 2000),
    ('Lambda', ' Etniografia Arquitectura ', 'Estado de México', 'Toluca', 'Ignacio Allende', 'Es una prueba', 3.4, 3000),
    ('Omega', ' Cultura Etniografia Arquitectura Antropologia Arqueologia ', 'Estado de México', 'Naucalpan', 'Miguel Hidalgo', 'Es una prueba', 2.6, 4000),
    ('Pi', ' Antropologia ', 'Estado de México', 'Metepec', 'Venustiano Carranza', 'Es una prueba', 1.8, 5000),
    ('Phi', ' Arqueologia Tecnologia Cultura ', 'Estado de México', 'San Mateo Atenco', '16 de Septiembre', 'Es una prueba', 1, 6000);